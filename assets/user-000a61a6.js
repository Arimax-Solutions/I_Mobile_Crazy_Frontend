import{r as a,j as t}from"./mui-core-8430a145.js";import{T as J}from"./topNavbar-62e82537.js";import{B as E}from"./buttons-bcb55ef0.js";import{S as l}from"./sweetalert2.all-4a184b36.js";import{a as g}from"./axios-dd1c8fc2.js";import{b as y}from"./utill-834e5e31.js";import"./index-e2260fdc.js";const te=()=>{const[S,k]=a.useState([]),[r,C]=a.useState(null),[p,n]=a.useState(""),[f,c]=a.useState(""),[o,i]=a.useState(""),[d,x]=a.useState(""),[h,m]=a.useState(""),[j,u]=a.useState(""),[v,I]=a.useState(""),[B,T]=a.useState(""),[U,A]=a.useState(""),[P,w]=a.useState(""),[$,b]=a.useState(""),[R,_]=a.useState(""),[O,D]=a.useState("");a.useEffect(()=>{N()},[]);const z=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),F=e=>/^[0-9]{10}$/.test(e),K=()=>{let e=!0;return p?T(""):(T("Please enter a name"),e=!1),f?A(""):(A("Please select a role"),e=!1),o?F(o)?w(""):(w("Please enter a valid contact number (10 digits)"),e=!1):(w("Please enter a contact number"),e=!1),d?z(d)?b(""):(b("Please enter a valid email address"),e=!1):(b("Please enter an email"),e=!1),h?_(""):(_("Please enter a username"),e=!1),j?D(""):(D("Please enter a password"),e=!1),e},N=async()=>{const e=localStorage.getItem("authToken");if(e){I(e);try{const s=await g.get(`${y}/api/users`,{headers:{Authorization:`Bearer ${e}`}});s.data&&Array.isArray(s.data.data)?k(s.data.data):console.error("Invalid data format received from server:",s.data)}catch(s){console.error("Error fetching items:",s)}}else console.log("No token found")},L=async()=>{if(!K())return;const e={name:p,role:f,contact_number:o,email:d,username:h,password:j};try{(await g.post(`${y}/auth/register`,e,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`}})).data.data!=null&&(l.fire({title:"Success!",text:"User added successfully",icon:"success",confirmButtonText:"OK"}),n(""),c(""),i(""),x(""),m(""),u(""),N())}catch(s){console.error("Error adding user:",s),l.fire({title:"Error!",text:"Failed to add user",icon:"error",confirmButtonText:"OK"})}},V=async e=>{try{await g.delete(`${y}/api/users/${e}`,{headers:{Authorization:`Bearer ${v}`}});const s=S.filter(H=>H.user_id!==e);k(s),C(null),l.fire({title:"Success!",text:"User deleted successfully",icon:"success",confirmButtonText:"OK"}),n(""),c(""),i(""),x(""),m(""),u(""),N()}catch(s){console.error("Error deleting user:",s),l.fire({title:"Error!",text:"Failed to delete user",icon:"error",confirmButtonText:"OK"})}},q=async()=>{if(!K())return;const e={name:p,role:f,contact_number:o,email:d,username:h,password:j};try{const s=await g.put(`${y}/api/users/${r==null?void 0:r.user_id}`,e,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`}});console.log(s),l.fire({title:"Success!",text:"User updated successfully",icon:"success",confirmButtonText:"OK"}),n(""),c(""),i(""),x(""),m(""),u(""),N()}catch(s){console.error("Error updating user:",s),l.fire({title:"Error!",text:"Failed to update user",icon:"error",confirmButtonText:"OK"})}},G=e=>{C(e),n(e.name),c(e.role),i(e.contact_number),x(e.email),m(e.username),u(e.password)};return t.jsxs("div",{className:"m-4 w-full",children:[t.jsx("div",{className:"m-4",children:t.jsx(J,{})}),t.jsxs("div",{className:"m-4 text-white font-semibold",children:[t.jsxs("div",{className:"mt-5 flex justify-between",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("input",{className:"text-feild",value:p,onChange:e=>n(e.target.value),placeholder:"   Name"}),B&&t.jsx("span",{className:"text-red-500 text-xs ml-[0.5vw]",children:B})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsxs("select",{className:"text-feild",value:f,onChange:e=>c(e.target.value),children:[t.jsx("option",{value:"",children:"Role"}),t.jsx("option",{value:"user",children:"User"})]}),U&&t.jsx("span",{className:"text-red-500 text-xs ml-[0.5vw]",children:U})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("input",{className:"text-feild",value:o,onChange:e=>i(e.target.value),placeholder:"   Contact Number"}),P&&t.jsx("span",{className:"text-red-500 text-xs ml-[0.5vw]",children:P})]})]}),t.jsxs("div",{className:"mt-4 flex justify-between",children:[t.jsxs("div",{className:"flex flex-col",children:[t.jsx("input",{className:"text-feild",value:d,onChange:e=>x(e.target.value),placeholder:"   Email"}),$&&t.jsx("span",{className:"text-red-500 text-xs ml-[0.5vw]",children:$})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("input",{className:"text-feild",value:h,onChange:e=>m(e.target.value),placeholder:"   Username"}),R&&t.jsx("span",{className:"text-red-500 text-xs ml-[0.5vw]",children:R})]}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("input",{className:"text-feild",value:j,onChange:e=>u(e.target.value),placeholder:"   Password"}),O&&t.jsx("span",{className:"text-red-500 text-xs ml-[0.5vw]",children:O})]})]})]}),t.jsxs("div",{className:"m-4 flex mt-5 justify-end",children:[t.jsx(E,{onClick:()=>L(),className:"mr-[6vw] buttons-styles bg-green-button w-[7vw] h-[5vh] text-center rounded-xl flex justify-center items-center",iconSrc:"src/assets/icons/Add Btn.svg",iconAlt:"add icon",children:"ADD"}),t.jsx(E,{onClick:()=>V((r==null?void 0:r.user_id)||0),className:"mr-[6vw] buttons-styles bg-red-button w-[8vw] h-[5vh] text-center rounded-xl flex justify-center items-center",iconSrc:"src/assets/icons/Delete Btn.svg",iconAlt:"delete icon",children:"DELETE"}),t.jsx(E,{onClick:()=>q(),className:"buttons-styles bg-blue-button w-[8vw] h-[5vh] text-center rounded-xl flex justify-center items-center",iconSrc:"src/assets/icons/Update Btn.svg",iconAlt:"update icon",children:"UPDATE"})]}),t.jsx("div",{className:"mt-5 m-4",children:t.jsxs("table",{className:"min-w-full divide-y table-styles",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Id"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact Number"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Username"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Password"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:S.map(e=>t.jsxs("tr",{onClick:()=>G(e),className:"text-white font-semibold hover:bg-gray-50 cursor-pointer",children:[t.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm font-medium text-gray-500",children:e.user_id}),t.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-500",children:e.name}),t.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-500",children:e.contact_number}),t.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-500",children:e.email}),t.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-500",children:e.username}),t.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-500",children:e.password}),t.jsx("td",{className:"px-6 py-2 whitespace-nowrap text-sm text-gray-500",children:e.role})]},e.user_id))})]})})]})};export{te as default};
